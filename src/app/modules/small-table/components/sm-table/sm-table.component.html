<h4>Test Cases</h4>
<!--Container that contains the main table-->
<dts-select-container #container="dts-select-container"
                      [(selectedItems)]="selectedDocuments"
                      [selectWithShortcut]="true">
  <div class="container">
    <div class="basic-container">
        <table>
          <tr>
            <th *ngFor="let col of columnNames; let i=index">
              <div style="margin-top: 10px; display: inline-block" *ngIf="(!searchMode && col === 'Tests') || col !== 'Tests'">
                {{col}}
                <span *ngIf="col != 'Comment'"
                      style="margin-left: 10px; cursor:pointer;"
                      (click)="changeSortingOrder(i)">{{sortingOrder[i] === undefined || sortingOrder[i] === null? sortingOrder[i]="▼" : sortingOrder[i]}}</span>
              </div>
              <img *ngIf="!searchMode && col === 'Tests'" (click)="enableSearchMode()"
                   src="./assets/images/search.png"
                   style="width: 25px; float: right; padding-top: 10px">
              <!--Input for search-->
              <form *ngIf="searchMode && col === 'Tests'" id="search">
                <span style="float: right; font-size: large; cursor: pointer; margin-top: 8px; margin-right: 10px"
                      (click)="disableSearchMode()"
                      *ngIf="searchMode && col === 'Tests'">×</span>
                <input type="text" placeholder="Test Name" name="myInput" [(ngModel)]="curInput" (keyup)="applyChange()">
              </form>
            </th>
          </tr>
          <tr *ngFor="let row of filteredTable; let i = index">
            <td [contextMenu]="testMenu"
                [contextMenuSubject]="row['Tests']"
                (contextmenu)="setTestSelected(i)"
                [ngClass]="selectedDocuments.length === 0 && isTestSelected[i] === true? 'selected-cell' : ''"
                [dtsSelectItem]="{'test': row, 'testName': row['Tests']}">
              {{row["Tests"]}}
            </td>
            <td class="{{item['Status']}}"
                *ngFor="let item of row['Data']; let j=index"
                [contextMenu]="statusMenu"
                [contextMenuSubject]="{'index': j, 'cur': item, 'test': row['Tests']}"
                (contextmenu)="setStatusSelected(i, j)"
                [ngClass]="selectedDocuments.length === 0 && isStatusSelected[i] !== undefined && isStatusSelected[i][j] === true? 'selected-cell' : ''"
                [dtsSelectItem]="{'status': row, 'testName': row['Tests'], 'id': j}">
              <span>{{item["Status"]}}</span>
              <br><br>
              <span *ngIf="item['fStatus'][0] === '---'">---</span>
              <ul style="margin-left: 15px" *ngIf="item['fStatus'][0] !== '---'">
                <li *ngFor="let f_s of item['fStatus']">{{f_s}}</li>
              </ul>
            </td>
            <td [contextMenu]="commentMenu"
                (contextmenu)="setCommentSelected(i)"
                [ngClass]="selectedDocuments.length === 0 && isCommentSelected[i] === true? 'selected-cell' : ''"
                [contextMenuSubject]="row['Tests']"
                [dtsSelectItem]="{'comment': row['Tests']}">{{ comment[row['Tests']] === undefined || comment[row['Tests']] === null? comment[row['Tests']]="No Comment":comment[row['Tests']] }}</td>
          </tr>
        </table>
    </div>
  </div>
</dts-select-container>
<!-- Context Menu for test name -->

<context-menu #testMenu (close)="isTestSelected = []">
  <ng-template contextMenuItem
               (execute)="showMessage('Hi, ' + $event)"
               [subMenu]="subTestMenu"
               let-item>
    Cur Selected: {{item}}
  </ng-template>
  <context-menu #subTestMenu>
    <ng-template contextMenuItem
                 *ngIf="isSelectedDocEmpty(myIndex) === true"
                 (execute)="showMessage('Hi, ' + $event.item)"
                 let-data>
      Item 1: {{data}}
    </ng-template>
    <span *ngIf="isSelectedDocEmpty(myIndex) === false">
      <ng-template contextMenuItem
                   (execute)="showMessage('Hi, ' + $event.item)"
                   *ngFor="let doc of selectedDocuments|selectedDocFilter:myIndex; let i = index">
        Item {{i+1}}: {{doc['testName']}}
      </ng-template>
    </span>
  </context-menu>
  <ng-template contextMenuItem let-item (execute)="showPopUpTableTest(selectedDocuments.length === 0? $event.item : selectedDocuments[0]['testName'])">Show More Info</ng-template>
</context-menu>

<!--Context menu for status-->
<context-menu #statusMenu (close)="isStatusSelected = []">
  <ng-template contextMenuItem
               (execute)="showMessage('Hi, ' + $event.item)"
               [subMenu]="subStatusMenu"
               let-data>
    Cur Selected: {{data['cur']['Status']}}
  </ng-template>
  <ng-template contextMenuItem
               (execute)="openTestExplorer()">
    Open Test Explorer (New Window)
  </ng-template>
  <context-menu #subStatusMenu>
    <ng-template contextMenuItem
                 *ngIf="isSelectedDocEmpty(myIndex) === true"
                 (execute)="showMessage('Hi, ' + $event.item)"
                 let-data>
      Item 1: {{data['cur']['Status']}}
    </ng-template>
    <span *ngIf="isSelectedDocEmpty(myIndex) === false">
      <ng-template contextMenuItem
                   (execute)="showMessage('Hi, ' + $event.item)"
                   *ngFor="let doc of selectedDocuments|selectedDocFilter:myIndex; let i = index"
                   let-data>
        Item {{i+1}}: {{doc['status']['Data'][ data['index'] ]['Status']}}
      </ng-template>
    </span>
  </context-menu>
  <ng-template contextMenuItem
               (execute)="showPopUpTableStatus(selectedDocuments.length === 0? $event.item['test'] : selectedDocuments[0]['testName'])">Show More Info</ng-template>
</context-menu>

<context-menu #commentMenu (close)="isCommentSelected = []">
  <ng-template contextMenuItem (execute)="open(content, $event.item)">
    Add New Comment
  </ng-template>
</context-menu>
<!--It's just the dark window that appears behind the pop up table-->
<div id="whole-window"
     *ngIf="isSubTableVisible"
     (click)="hideAllPopUps()"></div>
<!--------------------------------------------------------------------------------------------------->
<div class="small-container" *ngIf="isSubTableVisible">  <!--<div class="nav-table">-->
  <div id="controls">
    <h2>More Information</h2>
    <span (click)="hideAllPopUps()">×</span>
  </div>
  <div  style="margin-top: 70px">
    <ngb-tabset>
      <ngb-tab *ngFor="let cur_tab of tabs" title="{{cur_tab.val}}">
        <ng-template ngbTabContent>
          <table style="background-color:#fff;">
            <tr *ngFor="let col of allColumnData">
              <th> {{col}} </th>
              <td>
                {{allTableData[cur_tab['testName']][cur_tab.j][col]}}
              </td>
            </tr>
          </table>
        </ng-template>
      </ngb-tab>
    </ngb-tabset>
  </div>
</div>
<!-- Modal -->
<ng-template #content let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Adding New Comment</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <form>
      <div class="form-group">
        <label for="comment-content">Type Your Comment</label>
        <div class="input-group">
          <textarea id="comment-content" #txt_val class="form-control" placeholder="type your comment here.."></textarea>
        </div>
      </div>
    </form>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-outline-dark" (click)="modal.close(txt_val.value)">Save</button>
  </div>
</ng-template>
